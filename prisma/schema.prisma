generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Playground {
  id               String   @id @default(cuid())
  slug             String   @unique
  title            String
  summary          String
  markdown         String
  previews         Json?    // Store generated AI previews as JSON (text responses only)
  tags             String[]
  price            String?
  network          String   @default("solana-devnet")
  resourcePath     String   @unique
  publisherAddress String?
  status           PlaygroundStatus @default(DRAFT)
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  mediaAssets      MediaAsset[] // Generated media assets (images, audio, etc.)
}

model MediaAsset {
  id            String     @id @default(cuid())
  playgroundId String?    // Nullable - can be set later when playground is saved
  playground   Playground? @relation(fields: [playgroundId], references: [id], onDelete: Cascade)
  key          String     // Preview key (e.g., "image:0:Agent:prompt")
  type         String     // "image" | "audio" | "video" | etc.
  mimeType     String     // e.g., "image/png", "audio/mpeg"
  data         Bytes      // Binary data stored in database
  url          String     @unique // URL path to serve the asset
  createdAt    DateTime   @default(now())
  
  @@index([playgroundId])
  @@index([key])
}

enum PlaygroundStatus {
  DRAFT
  PUBLISHED
}

